"use strict";(self["webpackChunko2_dashboard"]=self["webpackChunko2_dashboard"]||[]).push([[22],{2022:(e,a,t)=>{t.r(a),t.d(a,{default:()=>Q});var o=t(3673),l=t(2323);const s=(0,o.HX)("data-v-31818c10");(0,o.dD)("data-v-31818c10");const n=(0,o.Wm)("div",{class:"text-h4"},"Companies",-1),i=(0,o.Wm)("div",{class:"text-subtitle1 q-mb-lg"},"All companies registered in the system.",-1),m={class:"row q-gutter-x-md q-gutter-y-sm"},d=(0,o.Wm)("div",{class:"text-h6"},"Edit Company",-1),p=(0,o.Wm)("div",{class:"text-h6"},"Create New Company",-1),u=(0,o.Wm)("div",{class:"text-h6"},"Are you sure?",-1),r={class:"q-mb-md"},c=(0,o.Wm)("br",null,null,-1),h=(0,o.Uk)("This request can not be undone once performed."),g={class:"col-auto"};(0,o.Cn)();const y=s(((e,a,t,y,C,w)=>{const f=(0,o.up)("q-btn"),b=(0,o.up)("q-card-section"),W=(0,o.up)("q-card"),k=(0,o.up)("q-expansion-item"),q=(0,o.up)("q-list"),v=(0,o.up)("q-input"),x=(0,o.up)("q-card-actions"),V=(0,o.up)("q-dialog"),_=(0,o.up)("q-checkbox"),D=(0,o.up)("q-page-sticky"),$=(0,o.up)("q-page"),S=(0,o.up)("q-spinner"),U=(0,o.Q2)("close-popup");return w.isSuperUser&&C.isLoaded?((0,o.wg)(),(0,o.j4)($,{key:0,padding:""},{default:s((()=>[n,i,(0,o.Wm)(q,{bordered:"",class:"rounded-borders"},{default:s((()=>[((0,o.wg)(!0),(0,o.j4)(o.HY,null,(0,o.Ko)(C.companies,(e=>((0,o.wg)(),(0,o.j4)(k,{key:e.id,"expand-separator":"",icon:"apartment",label:e.name,caption:"/"+e.slug},{default:s((()=>[(0,o.Wm)(W,null,{default:s((()=>[(0,o.Wm)(b,null,{default:s((()=>[(0,o.Wm)("div",m,[(0,o.Wm)(f,{color:"blue-9",label:"Edit company profile",icon:"edit",onClick:a=>{C.editingCompany={id:e.id,name:e.name,slug:e.slug},C.showEditCompanyDialog=!0}},null,8,["onClick"]),(0,o.Wm)(f,{color:"green-6",label:"Switch to this company",icon:"login",onClick:a=>{C.switchingCompany=e,w.switchCompany()}},null,8,["onClick"]),(0,o.Wm)(f,{color:"red-7",label:"Delete company",icon:"delete",onClick:a=>{C.deletingCompany=e,C.showDeleteCompanyDialog=!0}},null,8,["onClick"])])])),_:2},1024)])),_:2},1024)])),_:2},1032,["label","caption"])))),128))])),_:1}),(0,o.Wm)(V,{modelValue:C.showEditCompanyDialog,"onUpdate:modelValue":a[3]||(a[3]=e=>C.showEditCompanyDialog=e),persistent:""},{default:s((()=>[(0,o.Wm)(W,{style:{"min-width":"350px"}},{default:s((()=>[(0,o.Wm)(b,null,{default:s((()=>[d])),_:1}),(0,o.Wm)(b,{class:"q-pt-none q-gutter-y-sm"},{default:s((()=>[(0,o.Wm)(v,{filled:"",modelValue:C.editingCompany.name,"onUpdate:modelValue":a[1]||(a[1]=e=>C.editingCompany.name=e),label:"Company Name","stack-label":""},null,8,["modelValue"]),(0,o.Wm)(v,{filled:"",modelValue:C.editingCompany.slug,"onUpdate:modelValue":a[2]||(a[2]=e=>C.editingCompany.slug=e),label:"Company Slug","stack-label":""},null,8,["modelValue"])])),_:1}),(0,o.Wm)(x,{align:"right",class:"text-primary"},{default:s((()=>[(0,o.wy)((0,o.Wm)(f,{flat:"",label:"Cancel"},null,512),[[U]]),(0,o.wy)((0,o.Wm)(f,{flat:"",label:"Apply Changes",onClick:w.editCompany},null,8,["onClick"]),[[U]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(V,{modelValue:C.showCreateCompanyDialog,"onUpdate:modelValue":a[7]||(a[7]=e=>C.showCreateCompanyDialog=e),persistent:""},{default:s((()=>[(0,o.Wm)(W,{style:{"min-width":"350px"}},{default:s((()=>[(0,o.Wm)(b,null,{default:s((()=>[p])),_:1}),(0,o.Wm)(b,{class:"q-pt-none q-gutter-y-sm"},{default:s((()=>[(0,o.Wm)(v,{filled:"",modelValue:C.newCompanyName,"onUpdate:modelValue":a[4]||(a[4]=e=>C.newCompanyName=e),label:"Company Name","stack-label":""},null,8,["modelValue"]),(0,o.Wm)(v,{filled:"",modelValue:C.newCompanySlug,"onUpdate:modelValue":a[5]||(a[5]=e=>C.newCompanySlug=e),label:"Company Slug","stack-label":""},null,8,["modelValue"]),(0,o.Wm)(_,{"left-label":"",modelValue:C.switchToNewCompany,"onUpdate:modelValue":a[6]||(a[6]=e=>C.switchToNewCompany=e),label:"Switch to this company after creation","keep-color":"",color:"blue-9"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(x,{align:"right",class:"text-primary"},{default:s((()=>[(0,o.wy)((0,o.Wm)(f,{flat:"",label:"Cancel"},null,512),[[U]]),(0,o.wy)((0,o.Wm)(f,{flat:"",label:"Create",onClick:w.createCompany},null,8,["onClick"]),[[U]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(V,{modelValue:C.showDeleteCompanyDialog,"onUpdate:modelValue":a[9]||(a[9]=e=>C.showDeleteCompanyDialog=e),persistent:"","transition-show":"scale","transition-hide":"scale"},{default:s((()=>[(0,o.Wm)(W,{style:{width:"350px"}},{default:s((()=>[(0,o.Wm)(b,null,{default:s((()=>[u])),_:1}),(0,o.Wm)(b,{class:"row items-center"},{default:s((()=>[(0,o.Wm)("span",r,[(0,o.Uk)("To proceed to delete this company, please enter its name: ("+(0,l.zw)(C.deletingCompany.name)+")",1),c,h]),(0,o.Wm)(v,{modelValue:C.deleteCompanyInput,"onUpdate:modelValue":a[8]||(a[8]=e=>C.deleteCompanyInput=e),label:"Company's Name"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(x,{align:"right",class:"bg-white"},{default:s((()=>[(0,o.wy)((0,o.Wm)(f,{flat:"",label:"Cancel",class:"text-blue-9"},null,512),[[U]]),(0,o.wy)((0,o.Wm)(f,{label:"Confirm",class:"text-white",color:"red-7",onClick:w.deleteCompany,disable:C.deleteCompanyInput!==C.deletingCompany.name},null,8,["onClick","disable"]),[[U]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(D,{position:"bottom-right",offset:[50,50]},{default:s((()=>[(0,o.Wm)(f,{fab:"",icon:"add",color:"blue-9",onClick:a[10]||(a[10]=e=>C.showCreateCompanyDialog=!0)})])),_:1})])),_:1})):((0,o.wg)(),(0,o.j4)($,{key:1,class:"flex flex-center"},{default:s((()=>[(0,o.Wm)("div",g,[(0,o.Wm)(S,{color:"blue-9",size:"50px"})])])),_:1}))})),C={name:"Companies",data(){return{isLoaded:!1,companies:[],deletingCompany:null,showDeleteCompanyDialog:!1,deleteCompanyInput:"",switchingCompany:null,showEditCompanyDialog:!1,editingCompany:null,showCreateCompanyDialog:!1,newCompanyName:"",newCompanySlug:"",switchToNewCompany:!1}},methods:{unauthorizedRedirect(){this.$router.push("/"),this.$q.notify({message:"You are not authorized to use this page.",color:"red-7"})},loadCompanyList(){this.$api.get("/company/index").then((e=>{this.companies=e.data,this.isLoaded=!0})).catch((e=>{var a;this.$q.notify({message:void 0!==e.response.data.messages&&e.response.data.messages.length?e.response.data.messages[0]:null!==(a=e.response.data.message)&&void 0!==a?a:"Failed to execute this operation.",color:"red-9"})}))},deleteCompany(){this.$api.post("/company/"+this.deletingCompany.slug+"/destroy").then((e=>{this.$q.notify({message:e.data.messages[0],color:"green-9"}),this.loadCompanyList(),this.$store.dispatch("auth/checkAuth")})).catch((e=>{var a;this.$q.notify({message:void 0!==e.response.data.messages&&e.response.data.messages.length?e.response.data.messages[0]:null!==(a=e.response.data.message)&&void 0!==a?a:"Failed to execute this operation.",color:"red-9"})}))},switchCompany(e){this.$api.post("/company/"+(null!==e&&void 0!==e?e:this.switchingCompany.slug)+"/switch").then((e=>{this.$q.notify({message:e.data.messages[0],color:"green-9"}),this.$store.dispatch("auth/checkAuth")})).catch((e=>{var a;this.$q.notify({message:void 0!==e.response.data.messages&&e.response.data.messages.length?e.response.data.messages[0]:null!==(a=e.response.data.message)&&void 0!==a?a:"Failed to execute this operation.",color:"red-9"})}))},editCompany(){this.$api.post("/company/"+this.editingCompany.id+"/update",this.editingCompany).then((e=>{this.$q.notify({message:e.data.messages[0],color:"green-9"}),this.loadCompanyList()})).catch((e=>{var a;this.$q.notify({message:void 0!==e.response.data.messages&&e.response.data.messages.length?e.response.data.messages[0]:null!==(a=e.response.data.message)&&void 0!==a?a:"Failed to execute this operation.",color:"red-9"})}))},createCompany(){this.$api.post("/company/store",{name:this.newCompanyName,slug:this.newCompanySlug}).then((e=>{this.switchToNewCompany&&this.switchCompany(this.newCompanySlug),this.$q.notify({message:"Company "+this.newCompanyName+" created!",color:"green-9"}),this.loadCompanyList()})).catch((e=>{var a;this.$q.notify({message:void 0!==e.response.data.messages&&e.response.data.messages.length?e.response.data.messages[0]:null!==(a=e.response.data.message)&&void 0!==a?a:"Failed to execute this operation.",color:"red-9"})}))}},computed:{isSuperUser(){return this.$store.getters["auth/isSuperUser"]}},watch:{isSuperUser(e){e||this.unauthorizedRedirect()}},mounted(){this.isSuperUser?this.loadCompanyList():this.unauthorizedRedirect()}};var w=t(4379),f=t(7011),b=t(4615),W=t(151),k=t(5589),q=t(2165),v=t(6778),x=t(4842),V=t(9367),_=t(1420),D=t(1007),$=t(9754),S=t(677),U=t(7518),N=t.n(U);C.render=y,C.__scopeId="data-v-31818c10";const Q=C;N()(C,"components",{QPage:w.Z,QList:f.Z,QExpansionItem:b.Z,QCard:W.Z,QCardSection:k.Z,QBtn:q.Z,QDialog:v.Z,QInput:x.Z,QCardActions:V.Z,QCheckbox:_.Z,QPageSticky:D.Z,QSpinner:$.Z}),N()(C,"directives",{ClosePopup:S.Z})}}]);